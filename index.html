
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support.expected_conditions import presence_of_element_located
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.support import expected_conditions as EC
from oauth2client.service_account import ServiceAccountCredentials
from bs4 import BeautifulSoup
from math import ceil
import numpy as np
import pygsheets
import time
import json
import re
from selenium.webdriver.common.action_chains import ActionChains
import csv
import os
import pyperclip
from datetime import datetime
import pandas as pd
import gspread
from google.oauth2 import service_account
from google.auth.transport.requests import AuthorizedSession
from tabulate import tabulate
import pickle
options = webdriver.ChromeOptions()


driver = webdriver.Chrome(
    executable_path=r'C:/newsite/CraftDay/supervisorparse/chromedriver.exe', chrome_options=options)


def annotellid():
    datar = []
    driver.get("https://test.mindy-supports.com/new/AT/bd/pt.php")
    time.sleep(1)
    applepas = driver.find_elements_by_css_selector('body > input[type=button]:nth-child(3)')
    for i in applepas:
        i.click()
    requiredHtml = driver.page_source
    soup = BeautifulSoup(requiredHtml, 'lxml')
    time.sleep(1)
    webdriver.ActionChains(driver).key_down(Keys.CONTROL).send_keys("a").perform()
    webdriver.ActionChains(driver).key_down(Keys.CONTROL).send_keys("c").perform()
    
    driver.get("https://docs.google.com/spreadsheets/d/1L-GconZccVH9Wh_J_nvQ5HT6yapm494hnbwsXI6dpAQ/edit?usp=sharing")
    time.sleep(2)
    webdriver.ActionChains(driver).key_down(Keys.CONTROL).send_keys("v").perform()
    print('time copied:' + str(datetime.now()))
annotellid()
